\documentclass{article} 
\usepackage[style=nature,backend=biber]{biblatex}
\usepackage{graphicx}
\usepackage[font={it},labelfont={bf}]{caption}
\usepackage{times}
\usepackage{color}
%\usepackage{fixltx2e} % fixes placing of image positions
\usepackage{authblk}

\definecolor{customhdrcolor}{rgb}{0.0,0.0,0.0}
%\definecolor{customcitecolor}{rgb}{0.0,0.25,0.25}
\definecolor{customcitecolor}{rgb}{0.0,0.5,0.75}
%\definecolor{customlinkcolor}{rgb}{0.0,0.0,1.0}
\definecolor{customlinkcolor}{rgb}{0.0,0.5,0.75}

\usepackage[colorlinks=true,linkcolor=customlinkcolor,urlcolor=customlinkcolor,citecolor=customcitecolor,pdftex]{hyperref}

\ifpdf\pdfinfo{/Title      (Compressing raw radio-astronomical data)
               /Author     (A. R. Offringa et al.)
               /Keywords   (compression)
        }
\else\usepackage{graphics}\fi

\setlength{\pdfpageheight}{\paperheight}
\setlength{\pdfpagewidth}{\paperwidth}

\addbibresource{references.bib}
\addbibresource{compressrefs.bib}

\title{Compression of interferometric radio-astronomical data}

\author[1,2]{A.~R.~Offringa}
\affil[1]{RSAA, Australian National University, Mt Stromlo Observatory, via Cotter Road, Weston, ACT 2611, Australia}
\affil[2]{ARC Centre of Excellence for All-Sky Astrophysics (CAASTRO)}
\begin{document}

\label{firstpage}
\maketitle

\begin{abstract}
% Articles have a summary, separate from the main text, of up to 150 words, which does not have references, and does not contain numbers, abbreviations, acronyms or measurements unless essential. It is aimed at readers outside the discipline. This summary contains a paragraph (2-3 sentences) of basic-level introduction to the field; a brief account of the background and rationale of the work; a statement of the main conclusions (introduced by the phrase 'Here we show' or its equivalent); and finally, 2-3 sentences putting the main findings into general context so it is clear how the results described in the paper have moved the field forwards.
... TODO ...
\end{abstract}

\section{Background}
% up to 500 words of referenced text expanding on the background to the work (some overlap with the summary is acceptable), before proceeding to a concise, focused account of the findings, ending with one or two short paragraphs of discussion.
Unprocessed data from interferometric radio observatories consists of correlated signals from all the pairs of antennas that are part of the interferometric array. These correlated signals are measured in spectral channels, and integrated over short timesteps before they are recorded to disk \cite{thompson-radio-interferometry}.

Correlators in modern interferometric radio observatories output data at high spectral and temporal resolutions \cite{evla-perley-2011,mwa-2013-tingay,atca-broadband-backend-2011} (TODO cite LOFAR). It is often not desirable to decrease the resolution before archiving, because resolution in both dimensions provides scientific value. For example, high temporal resolution is desirable for pulsar observations~\cite{ska-pulsars-2009}, variability studies~\cite{lofar-pulsars-and-transients-2011} and advanced calibration methods that solve for the ionospheric disturbances and instrumental variabilities \cite{kazemi-clustered-cal-2013,revisiting-me-ii}. On the other hand, high frequency resolution is necessary for widefield imaging of the sky~\cite{big-book-on-synthesis-imaging}, spectral-line studies~\cite{evla-high-resolution-lines}(TODO cite more?) and accurate removal of man-made interference~\cite{lofar-radio-environment}. This can lead to data volumes of several petabytes, which have to be supported by complex network architectures to allow acceptable transfer rates \cite{lofar-processing-arch-2005} (TODO cite more). While current interferometers consist of up to a few hundred of antenna elements \cite{evla-perley-2011,mwa-2013-tingay,atca-broadband-backend-2011} (TODO cite LOFAR), future instruments will have thousands of antenna elements that will produce data at even higher resolutions or with multiple beams, thereby increasing the data volume and associated storage costs by several orders of magnitudes \cite{apertif-2010,ska-station-config-2013} (TODO cite ESKAP(?)). For these reasons, this paper considers the compression of correlated interferometric data.

Various multi-media and scientific applications have applied a variety of different compression techniques to decrease storage or transmission costs. Linear quantization can be effective for compression of noisy astronomical image \cite{astro-image-compression-2010}. Entropy-based encoding schemes such as Huffman encoding \cite{huffman} and prediction schemes (TODO cite Chebyshev polynomials) can optimize the representation of data. Decomposition into basis functions can provide a way to remove the less important bits in the data, such as the wavelet decomposition of audio data to remove tones that are nearly inaudible \cite{wavelet-audio-compression-1993}. In radio astronomy, linear quantization of the captured antenna voltages prior to correlation is common and well understood \cite{quantization-efficiency-2007}.

% TODO describe compression in the context of space missions, as it is interesting

% TODO compression in the context of radio astronomy? E.g., PAPER's compression technique

% TODO think about what this compression will do on HI observations(!)

% TODO raw data compression is different than image compression in the way that we don't care about the error in individual pixels; the total error is important!

\section{Methods}
We consider compressing correlator output samples that consist of complex values. These data commonly have a low signal-to-noise ratio (SNR), especially at high resolutions \cite{thompson-radio-interferometry}, and noise-like signals are inherently hard to compress without loss of information \cite{shannon-entropy-definition-1949}. In radio data, each complex component is normally stored as a 32-bit IEEE 754 single precision floating point value\footnote{See e.g. ``FITS Interferometry Data Interchange Format'', AIPS memo \#114, \S4.1;\\and ``MeasurementSet definition version 2.0'', CASA Memo \#229.}. We test two compression algorithms on recorded data from several telescopes. The first method is a loss-less technique using Huffman encoding \cite{huffman}, while the second method is a lossy encoding in the form of a non-linear minimized-squared-error quantization scheme \cite{least-squares-quantization-2006}. Both encodings are a-priory optimized for normally distributed complex samples with zero mean and a certain standard deviation. The distribution of correlated samples will approximate such a distribution more closely when the SNR is low (TODO cite) and does not contain interfering sources (TODO cite my own).

Loss-less compression is only effective for the 8-bit exponents of the floating point values, because the mantissa and sign follow closely a uniform distribution and are therefore incompressible without loss \cite{shannon-entropy-definition-1949}. We avoid very large dictionary sizes by applying the Huffman encoding on the 8-bit exponents only. To decrease loss of compression rate due to the integer number of bits required to represent symbols (TODO cite), the exponents of two consecutive samples are bitwise concatinated and encoded as such.

% TODO Maybe we should do the same for the lossless encoding?
In the lossy case, the standard deviation is determined dynamically, and individually stored for each pair of antennas and at each correlator time-step. The lossy quantization scheme is created by uniform sampling of the inverse of the corresponding cummulative distribution function.

\section{Findings}

\begin{table}
 \caption{Compression performances. The compressed sizes are the resulting file size relative to the original size. The speed is measured relative to reading/writing the data without compression.}
 \begin{tabular}{|l|c|c|c|c|c|}
  \hline
   & \multicolumn{2}{|c|}{Huffman} & \multicolumn{2}{|c|}{Lossy} \\
  Observation &  \multicolumn{1}{|c}{Size} & \multicolumn{1}{c|}{Enc speed} & \multicolumn{1}{|c}{Size}&\multicolumn{1}{c|}{Enc speed} \\
  \hline
  MWA HydA & 86\% & ..MB/s & 25\% & ..MB/s \\
  \hline
 \end{tabular}

\end{table}


\section{Discussion}

% TODO mention 16 quantization of VLA data

\printbibliography

\label{lastpage}

\end{document}
