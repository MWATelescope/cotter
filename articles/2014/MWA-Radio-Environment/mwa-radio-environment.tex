\documentclass{pasa}
\bibliographystyle{apj}
%\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{times}
\usepackage{color}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
%\usepackage{xspace}
\usepackage{subcaption}

%\usepackage{fixltx2e} % fixes placing of image positions

\definecolor{customhdrcolor}{rgb}{0.0,0.0,0.0}
\definecolor{customcitecolor}{rgb}{0.0,0.5,0.75}
\definecolor{customlinkcolor}{rgb}{0.0,0.5,0.75}

\usepackage[colorlinks=true,linkcolor=customlinkcolor,urlcolor=customlinkcolor,citecolor=customcitecolor,pdftex]{hyperref}

\ifpdf\pdfinfo{/Title      (Analysis of the Murchison radio environment for low-frequency astronomy)
               /Author     (A. R. Offringa et al.)
               /Keywords   (instrumentation: interferometers;methods: observational;techniques: interferometric;radio continuum: general)
        }
\else\usepackage{graphics}\fi
\usepackage{graphics}

\newcommand{\editmark}[1]{#1}
%\newcommand{\editmark}[1]{{\color{red}{\textbf{#1}}}}

\newcommand{\degree}{\ensuremath{^{\circ}}\xspace}

% To make Dutch ``tussenvoegsels'' work correctly in Latex such as ``de Bruyn'', we use this command
% It fixes ordering and uppercases.
% In text, it should be written with uppercase, as in ``De Bruyn''
\DeclareRobustCommand{\TUSSEN}[3]{#2}

\title[The Murchison radio environment]{The low-frequency Murchison radio environment:\\interference analysis and mitigation}

\def\ANU{$^{1}$}
\def\CAASTRO{$^{2}$}
\def\Curtin{$^{3}$}

\author[A.~R.~Offringa et al.]{A.~R.~Offringa$^{1,2}$\thanks{\editmark{Corresponding author.} E-mail: \url{andre.offringa@anu.edu.au}},
R.~B.~Wayth\Curtin$^,$\CAASTRO,
N.~Hurley-Walker\Curtin,
D.~Kaplan...,
... , %\newauthor
builders list
\\
\ANU{}Research School of Astronomy and Astrophysics, Australian National University, Canberra, ACT 2611, Australia \\
\CAASTRO{}ARC Centre of Excellence for All-sky Astrophysics (CAASTRO), Australian National University, Canberra, ACT 2611, Australia \\
\Curtin{}International Centre for Radio Astronomy Research, Curtin University, Bentley, WA 6102, Australia\\
}
\jid{PASA}
\doi{10.1017/pas.\the\year.xxx}
\jyear{\the\year}
%Citations may be made using the natbib commands \citet{},\citep{} etc.
\usepackage[authoryear]{natbib}
\bibpunct{(}{)}{;}{a}{}{,}
\setlength{\bibsep}{0.3mm}

\begin{document}
\maketitle

%\date{Accepted TODO. Received TODO; in original form TODO}
%\pagerange{\pageref{firstpage}--\pageref{lastpage}}
%\pubyear{2014}

\label{firstpage}

\begin{abstract}
...
\end{abstract}

\begin{keywords}
instrumentation: interferometers -- methods: observational -- techniques: interferometric -- radio continuum: general
\end{keywords}

\section{Introduction}
In recent years, the issue of radio-frequency interference (RFI) in radio astronomy caused by man-made transmitters has become larger due to an increased number of transmitters and wider frequency bandwidths of radio observatories. Spectrum allocation management and radio-quiet zones help to limit the interference, but do not solve interference from air-based transmitters or accidential electromagnetic radiation, for example from cars or wind turbines.

While some success has been seen in filtering interference from observations in which the data samples are cleaned from the contribution of interference \citep{spatial-filtering-parkes-multibeam-for-pulses,rfi-spatial-processing-hellbourg-2014}, such an approach is often not feasible due to technical limitations or the type of RFI. Therefore, a common approach is detection of contaminated data and ignoring these samples in further data analysis \citep{post-correlation-rfi-classification}. The consequence of the latter approach is that a certain amount of data is lost due to interference, and that frequencies that are continuously occupied by transmitters can not be observed. Analysing the results of interference detection and improving the understanding of RFI contamination can aid in several ways: understanding the effects on the science; improved observation scheduling; designing hardware and location of future telescopes with a maximal cost/benefit approach; and enforcing spectrum management strategies that are most beneficial for the observatories.

In this article, we will look specifically at the RFI situation of the MWA \citep{mwa}. The MWA is a low-frequency array consisting of 128 tiles, each with 16 dual-polarized dipoles, which allow observing between 80--300~MHz with a 31-MHz instantaneous bandwidth. Its main science driver is to detect redshifted 21-cm radio signals from the Epoch of Reionization (EoR; \citealt{bowman-science-with-the-mwa-2013}). To avoid as much RFI as possible, the MWA is located in the Murchison region in Western Australia. Analysing the interference situation of the MWA can improve the MWA observing and processing strategy, and will additionally also provide valuable information for the Square Kilometre Array (SKA), because the cores of the SKA low-frequency aperture arrays and SKA mid-frequency survey dishes are planned to be build near the location of the MWA.

The interferometric arrays LOFAR, PAPER and the Long Wavelength Array (LWA) are all designed to perform 21-cm EoR science, and all observe in approximately the same frequency range as the MWA. Comparing the MWA to these arrays therefore allows the comparison of the observatory site and hardware design with respect to the RFI mitigation effectivity. In \citet{lofar-radio-environment} it has been shown that the radio environment of LOFAR does not pose any issues on regular observations despite that, unlike the MWA, LOFAR is build in a populated area. This is confirmed by \citet{ncp-eor-yatawatta}, where the authors analyse the first imaging of EoR long-integration observations with LOFAR. They reach near-thermal noise sensitivity, and argue that RFI is not a limitation for further increasing the sensitivity. Further analysis showed that RFI models for LOFAR can estimate the leakage of the RFI detection \citep{offringa-rfi-distributions}. Those analyses concluded that with sufficient precautions, such as good receiver design and accurate detection methods, the leaked RFI is weak and averages down similar to Gaussian noise.

TODO paper structure.

\section{Method}
RFI detection, often referred to as ``data flagging'', is one of the first steps in the data processing. It is important to perform initial data flagging at high time and frequency resolution, because this increases detection accuracy and decreases the loss of data \citep{lofar-radio-environment}. Consequently, RFI detection has to work on large data volumes, and its computational cost is therefore a concern -- in particular for many-element arrays. In some projects, simple thresholding is used to mitigate the worst interference, which is computationally cheap but not very accurate. For example, a $3\sigma$ threshold is used for reducing PAPER data in \citet{parsons-paper-eorlimit-2014}. Several observatories or projects have designed pipelines that include more advanced RFI mitigation. Examples of such pipelines include \textsc{aoflagger} \citep{post-correlation-rfi-classification,scale-invariant-rank-operator}, originally designed for LOFAR; \textsc{flagcal} for preprocessing data from the Giant Metrewave Radio Telescope (GMRT; \citealt{prasad-flagcal-2012}); and \textsc{serpent} for preprocessing data from the Multi-Element Radio Linked Interferometer Network (e-MERLIN; \citealt{serpent-peck-2013}). For RFI detection in MWA observations, LOFAR's \textsc{aoflagger} is used. This flagger has shown to have a good accuracy, is fast and has a library interface, which allows it to be integrated in a pipeline.

\subsection{The \textsc{aoflagger} RFI detector}

\begin{figure}
\begin{center}\hspace*{-0.8cm}\includegraphics[width=10.5cm]{img/bandpass}
\caption{Correlator output RMS over frequency in an MWA high-frequency observation, calculated over all cross-correlated baselines and 112 seconds of data. In this band, the band-pass shows two large discontinuities over frequency, because the MWA receivers apply different digital gains at different frequencies to minimize quantization noise. The 1.28~MHz pattern is due to the imperfect poly-phase filter.
}
\label{fig:bandpass}
\end{center}
\end{figure}

To detect RFI in MWA observations, we have used the \textsc{aoflagger} and implemented this as a standard MWA tool to flag all MWA data. The \textsc{aoflagger} allows customizing its flagging strategy, such as changing the threshold levels and expected smoothness of good data. Optimal values vary from telescope to telescope because of different band-pass shapes, different time and frequency resolutions and varying field of views. Specific strategies for several telescopes have been implemented in the \textsc{aoflagger} software, including an MWA specific strategy which is used in this work. The different \textsc{aoflagger} strategies are variations on the original LOFAR strategy described in \citet{lofar-radio-environment}. In the LOFAR strategy, the sky contribution is estimated by applying a 2-dimensional high-pass filter on the visibility amplitudes of each baseline in the time and frequency direction. Subsequently, line-shaped features are detected by the \textsc{sumthreshold} method, which is a combinatorial threshold method \citep{post-correlation-rfi-classification}. After iterating these steps a few times, the scale-invariant rank (SIR) operator is applied on the two-dimensional flag mask. The SIR operator is a morphological technique to search for contaminated samples \citep{scale-invariant-rank-operator}.

The MWA and LOFAR strategies differ on one aspect. For the MWA, an extra bandpass correction is added, which is performed by dividing the bandwidth in 48 parts and dividing each part by its Winsorized standard deviation. This step is required to smooth out discontinuities due to varying digital gains over frequency that are applied by the receivers to minimize quantization noise. An example of these discontinuities is shown in Fig.~\ref{fig:bandpass}. The bandpass corrections are not permanently applied to the data, but only applied during flagging. Normally, a per-channel calibration is performed after flagging for getting accurate flux calibration, which corrects the gain discontinuities permanently. Recently, the applied digital gains have been smoothed to prevent these discontinuities, which makes it possible to skip the band-pass correction step, but this step was still included in this work. 

In this work, \textsc{aoflagger} version 2.6 released on 26 June 2014 is used.

\subsection{\textsc{cotter}: the MWA preprocessing pipeline}

The \textsc{aoflagger} software provides a C++ library%TODO \footnote{\url{http://aoflagger.sourceforge.net/doc/api/}}
that can be integrated in a pipeline, thereby minimizing reading/writing of data. We have written an MWA-specific preprocessing pipeline named \textsc{cotter} that uses the \textsc{aoflagger} library for RFI detection. RFI detection is only performed on cross-correlations. Auto-correlations are normally removed, because they are not used in imaging. In addition to the RFI detection, \textsc{cotter} performs the following steps: it converts the raw correlator files into \textsc{casa} measurement sets or uvfits files; applies bandpass gain corrections; corrects the phases for varying cable lengths; calculates the $uvw$-coordinates; applies phase tracking to the desired sky coordinates; flags samples from the correlator that are missing or incorrect; and allows averaging the observation in frequency or time direction to reduce the data volume. It also collects various statistics and writes these into a measurement set using the LOFAR quality statistics format\footnote{Described in ``MeasurementSet description for LOFAR version 2.08'' by Schoenmakers \& Renting.}. Various tools are available to analyse these statistics, e.g. the \textsc{aoqplot} tool that is part of the \textsc{aoflagger} software can plot the statistics over various dimensions in an interactive manner.

MWA observations are split into snapshots of a few minutes by the correlator. The MWA archive stores the raw correlator outputs for every snapshot as an observation that can be referenced by its observation ID. For more details about the correlator, see TODO fix reference Ord et al. (2014). Currently, the \textsc{cotter} preprocessing pipeline is ran by the scientist that calibrates and images the data. Once the scientist has downloaded the raw files for a given observation ID, there are various ways of processing MWA data. For imaging MWA data with the Real-Time System (RTS; \citealt{rts-mwa-2008}), \textsc{cotter} is ran in a special mode such that it only flags the data, and does not convert the raw correlator files. After running \textsc{cotter}, the raw files and a flag mask are given as input to the RTS. For more traditional data processing with e.g. \textsc{casa} or \textsc{miriad}, the \textsc{cotter} output is set to either the \textsc{casa} or uvfits format. The output is then directly readable by the astronomical software.

One particular issue in implementing \textsc{cotter} is that both the raw correlator files and the desired output files are ordered in time, but flagging is done baseline by baseline. The \textsc{sumthreshold} technique and the scale-invariant rank operator that are used by the flagging strategy, use statistics over large time and frequency ranges. Therefore, accuracy is improved when the time-frequency flagging intervals are as large as possible. However, a typical snapshot is about 50 GB in size, and without increasing reading and writing, it requires thus 50 GB of memory to perform flagging on the full data. When less memory is available, \textsc{cotter} will split the observation in different time chunks and flags those independently. The \textsc{ndppp} software used by LOFAR (TODO reference?) uses a similar partitioning of data to overcome the time-ordering problem. Partitioning the data has the undesirable behaviour that executing \textsc{cotter} on a low-memory machine decreases its flagging accuracy. Because not all astronomers might have easily access to high-memory machines, a platform with sufficient memory has been setup that pre-runs \textsc{cotter} on all observations.

When time or frequency averaging is requested, \textsc{cotter} averages samples together that have not been flagged. When all input samples are flagged, the average of all input visibilities is stored into the the output sample, and the output sample is flagged. This method makes it possible to superficially analyse flagged samples in the output, even though information is lost in the averaging. \textsc{cotter} stores a weight for each visibility in the output file, which is scaled to the number of unflagged input samples that were used for the output sample. Because of this, when no averaging is requested, the output is 50\% larger than the input (one extra float per complex float visibility). In practice, most observations are recorded at a resolution of 0.5 s and 40 kHz, and averaged to a resolution of 2--4 s and 40--80 kHz to reduce the data volume. This does not significantly cause any time or bandwidth decorrelation up to the first beam nul. \textsc{cotter} performs the phase shifting and cable delay corrections before averaging, and recalculates the $uvw$ values for the central time and frequency of the output sample. This helps to prevent time/frequency decorrelation.

\begin{table*}
\caption{List of observations used in the analyses. The RFI column contains the fraction of visibilities that the initial \textsc{aoflagger} run has classified as RFI (which includes false positives). The DVB column displays the fraction of visibilities that were unusable because of the presence of DVB signals, and which the flagger does not flag. Not all observations cover the DVB frequencies. }\label{tbl:obs-list}
\begin{center}%
\begin{tabular}{|l|l|r|r|r|c|}
\hline
\textbf{Project} &\textbf{Date} & \textbf{Frequencies (MHz)} & \textbf{Duration} & RFI & DVB \\
\hline
EoR high& 2013-08-23 & 167.0--197.7              & 3h & 0.53\% & 0\% \\
GLEAM & 2013-08-25 & 72.3--133.8, 138.9--230.8 & 7h & 0.94\% & 0\% \\
EoR low& 2013-08-26 & 138.9--169.6              & 6h & 0.81\% & ---\\
GLEAM & 2013-11-05 & 72.3--133.8, 138.9--230.8 & 7h & 1.27\% & 0\% \\
GLEAM & 2013-11-25 & 72.3--133.8, 138.9--230.8 & 7h & 0.69\% & 0\% \\
EoR high& 2014-02-05 & 167.0--197.7              & 6h & 0.54\% & 0\%\\
GLEAM & 2014-03-16 & 72.3--133.8, 138.9--230.8 & 7h & 0.79\% & 0\% \\
GLEAM & 2014-03-17 & 72.3--133.8, 138.9--230.8 & 7h & 1.64\% & 30\% \\
EoR high& 2014-04-10 & 167.0--197.7              & 6h & 0.68\% & 0\%\\
GLEAM & 2014-06-18 & 72.3--133.8, 138.9--230.8 & 7h & 0.98\% & 0\% \\
Orbcomm RFI test&2014-08-27& 131.2--161.9     & 2$\times$8 m& 1.85\% & --- \\
\hline
\multicolumn{3}{|r|}{\textbf{Total}} & \textbf{63h} & \textbf{0.96\%} & \textbf{3\%}\\
\hline
\multicolumn{4}{|r|}{\textbf{With uniform channel coverage}} & \textbf{1.13\%} & \\
\hline
\end{tabular}
\end{center}
\end{table*}

\section{Data description}
We analyze the RFI in 10 nights of data from two different MWA projects: the MWA EoR project \citep{bowman-science-with-the-mwa-2013} and the GaLactic and ExtrAgalactic MWA (GLEAM) survey (TODO cite Randall). The observation nights are listed in Table~\ref{tbl:obs-list}.

The MWA EoR project observes primarily in the 138.9--197.7~MHz range, covering the HI 21-cm line with redshift 6.1--9.2. Because the MWA has a 30.72~MHz instantaneous bandwidth, this range has been split up so that each night observes with a central frequency of either 154.2 or 182.4~MHz, with an overlap of 2.6 MHz. In these observations, the selected EoR field is tracked by the primary beam, such that the sensitivity towards the field is maximal. The GLEAM survey covers 72.3--230.8 MHz split into 5 bands of 30.72 MHz. The GLEAM observations are made in drift-scan mode, and the 5 bands are observed one by one in 5 subsequent snapshots.

Both projects avoid the subbands that cover the frequency range 133.8--138.9~MHz, because the ORBCOMM low Earth orbitting (LEO) satellites transmit in these subbands. When these frequencies are observed, the subbands are often so strongly contaminated that it affects imaging sensitivity. For completeness, we include a 16-min observation that covers this frequency range.

The poly-phase filter bank that performs the first separation into subbands, introduces a 1.28~MHz periodic spectral signature. This shape is e.g. visible in Fig.~\ref{fig:bandpass}. The poly-phase filter band-pass shape is hard to take out completely, because the filters are imperfect and each sub-band is effected by leakage from signals in its adjacent sub-bands. The leakage from adjacent sub-bands manifests itself as if the sub-band band-pass is direction dependent. To solve this, the bordering 80~kHz on both sides of a 1.28~Mhz subband are normally flagged by \textsc{cotter}. This implies that in normal observations, 13\% of the data is lost due to the poly-phase filter. However, while 80~kHz is sufficient to prevent imaging artefacts, we noticed that the RFI statistics were still slightly biased by the edge channels. Therefore, for the analyses in this paper we increase the number of removed edge channels to 200~kHz on either side of each 1.28~MHz sub-band, or 32\% in total.

\noindent\begin{figure*}
\begin{center}\hspace*{-0.2cm}\includegraphics[width=18cm]{img/rfi-per-band}
\caption{RFI occupancy per subband, calculated over all observations except GLEAM 2014-03-17. The latter has been left out because it is affected by DVB.}
\label{fig:rfi-per-band}
\end{center}
\end{figure*}

\noindent\begin{figure*}
\begin{center}\hspace*{-0.2cm}\includegraphics[width=18cm]{img/plot-stddev-per-set}\vspace{-1cm}
\caption{Observed noise in the high-resolution channels for each observation. This is the residual noise in the visibilities after RFI detection. A few channels in the FM bands show a deviating standard deviation, and observation `GLEAM 2014-03-17' shows DVB contamination around 180~MHz.}
\label{fig:stddev-per-set}
\end{center}
\end{figure*}

\section{Detection results}
The fifth column of Table~\ref{tbl:obs-list} lists for each of the observation nights the ratio of samples that were classified as RFI by the \textsc{aoflagger} in the cross-correlations. This includes false detections, which are estimated in \citet{lofar-radio-environment} to account for approximately 0.4\% detections. Compared to the EoR observations, the GLEAM observations have a higher average of 1.05\% of RFI. This is mostly caused by the FM bands, which are only observed in GLEAM observations. The EoR low-band night shows 0.81\% RFI, while the EoR high-band observations have an average of 0.58\%. The total RFI occupancy in all observations is 0.96\%. Weighting the occupancy in each channel by the inverse time that it is observed results in an occupancy of 1.13\%, which is the global expected RFI ratio in the 72.3--230.8 MHz range.

Fig.~\ref{fig:rfi-per-band} shows the overal detected RFI occupancy per sub-band, as calculated over all observations except GLEAM 2014-03-17. The latter is the only night affected by interference from digital video broadcasting (DVB), and will be analysed later. The FM bands around 100~MHz and the ORBCOMM bands around 138~MHz are clearly present in the data. Excluding the RFI from DVB, the EoR high band is again slightly cleaner than the EoR low band, as its worst subband at 188.2 MHz has 1.03\% occupancy. The sub-bands at 145.9 and 149.8~MHz in the EoR low band have both 2.1\% occupancy. TODO what are these transmitters?

The residual noise levels after flagging can be used to validate whether the flagged data is free of RFI. In Fig.~\ref{fig:stddev-per-set}, the residual noise levels are plotted per high-resolution channel for each of the observations. Observation `GLEAM 2014-03-17' shows residual DVB interference, and it is clear that this RFI has not been adequately flagged. Therefore, observations have to be cleaned of DVB with another method. Additionally, some channels in the FM and 2-m amateur bands show standard deviations that deviate slightly as a result from the smaller amount of available data after flagging and because of RFI leakage, but because the effect is small these frequencies can be calibrated and imaged without a problem. The subband at 137~MHz that is occupied by ORBCOMM is hard to calibrate because of the small amount of residual data per channel, and possibly also because of residual RFI. With the exception of the ORBCOMM frequencies and DVB affected nights, the RFI detection employed in \textsc{cotter} is sufficient to allow calibration and imaging without further RFI mitigation efforts. This is verified by early imaging results from the GLEAM survey and the MWA commissioning survey \citep{mwacs-2014}.

\noindent\begin{figure*}%
% obs data: 1061583576, 2013-08-26.
\begin{center}\hspace*{-0.2cm}\includegraphics[width=10cm]{img/dvb_example}\includegraphics[width=5cm]{img/2014-03-17-dvb-stddevs}
\end{center}
\caption{RFI from Digital Video Broadcasting (DVB), which is visible in 1 of the 9 observations (GLEAM~2014-03-17) that cover the DVB frequencies. Left plot: dynamic spectrum for the worst affected snapshot; right plot: visibility RMS in a few of the DVB bands for the affected night after flagging. Because of its broadband nature, this kind of RFI is not well flagged in the initial \textsc{aoflagger} step, but it is detectable in the global statistics. }
\label{fig:dvb}
\end{figure*}

Because significant DVB interference is left in `GLEAM 2014-03-17' after flagging, we have analysed this night more extensively. The DVB transmitters are terrestrial, and the fact that only this night observes the DVB, implies the RFI must originate from an over-the-horizon transmitter that is reflected by unusually strong ionospheric activity. As can be seen in the left plot of Fig.~\ref{fig:dvb}, this kind of RFI can fully contaminate frequencies 174--195~MHz, thus over half of the instantaneous bandwidth. Because the \textsc{aoflagger} determines its thresholding levels from the data, and because it needs to be insensitive for steep RMS jumps over frequency due to the varying coarse channel gains (see Fig.~\ref{fig:bandpass}), it is insensitive for RFI that is this broad.

Although the flagger does not adequately flag DVB, the right plot of Fig.~\ref{fig:dvb} shows that it is possible to determine whether a snapshot is affected by DVB interference from the data statistics. An option is to test whether the visibility RMS of a snapshot in any of the occupied DVB bands exceeds the RMS in DVB band 4, which is not used for broadcasting. These statistics are calculated by \textsc{cotter}, hence this can be validated without having to read the data again. When DVB is detected in a snapshot, the entire snapshot can be removed or the residual unaffected data within the snapshot can be used. However, it might not be worth it to have special mechanisms in place, such as having to account for lower SNR and a decreased $uv$ coverage, to salvage the residual good data within an affected snapshot. Because 2 out of 7 hours are affected in 1 out of the 9 randomly selected nights, the probability of observing DVB is roughly 3\%. This is detailed in the last column of Table~\ref{tbl:obs-list}. 

\noindent\begin{figure*}
\begin{center}\hspace*{-0.2cm}\includegraphics[width=18cm]{img/lognlogs-multiplot}
\caption{Visibility amplitude distributions with logarithmic axes. The dashed line represent fits over a reasonably constant part of the tail (selected by eye) of the RFI distribution: $N=\beta S^{-1.43}$ for GLEAM, $N=\beta S^{-4.47}$ for EoR high and $N=\beta S^{-1.33}$ for EoR low.}
\label{fig:lognlogs}
\end{center}
\end{figure*}

\subsection{Distribution analysis}
In \citet{offringa-rfi-distributions}, using LOFAR it is shown that when many interfering transmitters are observed, the distribution of the visibility brightness will have a power-law tail with an exponent of approximately -1.5 to -1.6. For the GLEAM, EoR high-band and EoR low-band observations of this work, the distributions are drawn in Fig.~\ref{fig:lognlogs}. The three distributions are different due to the fact that each observation covers different frequencies.  Separate distributions are shown for visibilities that have been detected as RFI (red lines) and those that have been classified as RFI free (green lines). The EoR high-band curves do not include the night that was contaminated by DVB RFI.

The distribution curves of RFI-detected samples do not show a very significant power-law tail. Fits over regions selected by eye have been added to Fig.~\ref{fig:lognlogs}. The EoR high-band observes too little RFI to generate such a power law, which is reflected by its fit of $N=\beta S^{-4.47}$, with $\beta$ being a scaling factor. The GLEAM and EoR low-band observations do show a small power-law part, but the fitted exponent depends strongly on what part of the tail is selected. The selected regions result in $N=\beta S^{-1.43}$ and $N=\beta S^{-1.33}$ for the GLEAM and Eor-low curves, respectively.

In the ideal case, the residual visibility distributions show a smooth Rayleigh curve (see \citealt{offringa-rfi-distributions}). The residual curves in Fig.~\ref{fig:lognlogs} do not go down as quickly as a Rayleigh curve would, and therefore the distributions have a slight excess of samples with higher amplitudes. This excess is caused by the multi-variate nature of the data, for example because the noise level increases when the Galaxy goes through the beam. The EoR-high distribution has some extra features in its tails that are not smooth. Further analyses showed that these are also caused by the Galaxy, causing a few short baselines to observe samples with high amplitudes. Visual inspection of snapshots with a non-smooth residual distribution tail did not show residual RFI in such sets.

\noindent\begin{figure*}
\subcaptionbox{RFI contamination found in the 2 m amateur band (146 MHz).}[\linewidth]{%
% obs data: 1061583576, 2013-08-26.
\includegraphics[width=9.1cm]{img/amateur-2m-band-example}\includegraphics[width=9.1cm]{img/amateur-2m-band-flagged}
\label{fig:amateur-2m}
}\\\vspace{3mm}%
\subcaptionbox{Short RFI burst of 2 s centred on 150.17 MHz. Detection of this kind of RFI requires flagging at high time and frequency resolution.}[\linewidth]{%
% obs data: 1061583576, 2013-08-26.
\includegraphics[width=9.1cm]{img/150_2_mhz_example_ann}\includegraphics[width=9.1cm]{img/150_2_mhz_flagged_ann}
\label{fig:150_2}
}%
\caption{RFI events found in the EoR low band (138.9--169.6 MHz) in a 2-min snapshot with relatively high RFI contamination. These panels show the Stokes I amplitudes. In the right figures, the result of RFI detection is shown with purple. The horizontal flagged lines are flagged because they are 1.28-MHz subband edge or centre channels, which are unusable because of aliasing of the poly-phase filter bank and DC offsets, respectively.}
\label{fig:2m-amateur-band}
\end{figure*}

\noindent\begin{figure*}%
% obs data: 1075641128
\begin{center}\hspace*{-0.2cm}\includegraphics[width=8cm]{img/EoR-high-band-DVB-burst-example-noflags}\includegraphics[width=8cm]{img/EoR-high-band-DVB-burst-example-withflags}
\end{center}
\caption{DVB RFI briefly visible in an EoR high-band observation. The plots show the Stokes~I amplitudes for a single correlation. The right plot shows the result of RFI detection marked in purple.}
\label{fig:dvb-burst}
\end{figure*}

\noindent\begin{figure*}%
% obs data: 1075637224
\begin{center}\hspace*{-0.2cm}\includegraphics[width=8cm]{img/broadband-pulse-unflagged}\includegraphics[width=8cm]{img/broadband-pulse-flagged}
\end{center}
\caption{Broadband pulses found in an EoR high-band observation. The two panels show Stokes~I visibility amplitudes of a single correlation. In the right plot, the RFI detection flags are marked with purple. Each event occupies 2 timesteps of 0.5~s.}
\label{fig:broadband-pulse}
\end{figure*}

\noindent\begin{figure*}%
% obs data: 1061583576, 2013-08-26.
\begin{center}
\includegraphics[width=9.1cm]{img/156_7_mhz_example}\includegraphics[width=9.1cm]{img/156_7_mhz_flagged}\\
\includegraphics[width=9.1cm]{img/156_7_mhz_stddev}\includegraphics[width=9.1cm]{img/156_7_mhz_stddev_flagged}
\caption{A weakly-observed transmitter centred on 156.66 MHz. Top-left window: a single correlation, where the transmitter is barely visible; Top-right window: detected RFI marked with purple. When performing per-baseline flagging, the transmitter is partly detected; Bottom-left window: when combining data from all baselines, the transmitter becomes clearly visible; Bottom-right window: in yellow, result of executing \textsc{aoflagger} on the standard deviations calculated over all baselines.}\label{fig:156_7}
\end{center}
\end{figure*}

\subsection{RFI types}
A variety of RFI events types are observed in the data sets. While there are too many transmitters to show examples for each, it is helpful to understand what kind of events are visible and how they are flagged by the \textsc{aoflagger}. Therefore, a few typical examples are shown.

Fig.~\ref{fig:2m-amateur-band} shows two examples of RFI events in the same EoR low-band snapshot: the top panels display the Stokes~I values of a single correlation, in which a transmitter has been observed in the 2-m amateur band (146 MHz). This is the worst contamination in our data sets by this transmitter, and there are also snapshots in which the transmitter is not visible at all. This variability might be caused by intrinsic variation or movement of the transmitter or varying propagation conditions. While a change in pointing can also change the appearance of the transmitter, the beam does not change within a single snapshot, while in Fig.~\ref{fig:2m-amateur-band} the strength and affected bandwidth of the transmitter does change during the snapshot. In the bottom panel of Fig.~\ref{fig:2m-amateur-band}, the same snapshot is showed but is zoomed in on a briefly-observed RFI event at 150.17 MHz. This event occupies only a single 40~kHz channel for 2 seconds, and thus is an event which requires flagging at approximately the observed time and frequency resolution or higher for accurate detection.

Besides persistent transmissions that occupy a few channels, transient broad-band events are observed as well. Occassionally, DVB RFI is visible for a brief moment, as for example visible in Fig.~\ref{fig:dvb-burst}. As can be seen in the right plot of Fig.~\ref{fig:dvb-burst}, such a brief interference is well flagged by the \textsc{aoflagger}. Another transient broad-band example is displayed in Fig.~\ref{fig:broadband-pulse}, which shows strong broad-band pulses of a second in length. Strong pulses such as these are rare and well flagged, but a few weak broad-band pulses are observed in almost every 2-min snapshot. These weak pulses are not visible nor detected in a single baseline correlation, but can be seen in a dynamic spectrum when the power of all baselines are added together. We currently do not know what their origin is, but it is likely they are \textit{in situ} generated RFI or receiver saturations much shorter than the integration time. The MWA Voltage Capture System (VCS; TODO cite) might help to analyze these phenomena.

Fig.~\ref{fig:156_7} shows a longer RFI contamination at 156.66~MHz that is hardly visible in a single correlation. The \textsc{aoflagger} detects this RFI partially (Fig.~\ref{fig:156_7}, top-right plot), but when plotting the standard deviation over all correlations in a dynamic spectrum, it is evident that this RFI transmitter is not completely detected (Fig.~\ref{fig:156_7}, bottom-left plot). The detection becomes more complete when the \textsc{aoflagger} is executed on the standard deviations over all baselines (Fig.~\ref{fig:156_7}, bottom-right plot). This kind of detection is currently not implemented in \textsc{cotter}.

\subsection{Computational performance of \textsc{cotter}}
Because \textsc{cotter} processes the data at high resolution, its computational performance is an important consideration. A major contribution to the runtime is the reading and writing of the data, and the runtime is thus influenced by the input-output (IO) performance of the host system. Excluding IO, the main computational performance of \textsc{cotter} consists of running \textsc{aoflagger} on the data and collecting the statistics; performing all its other tasks such as applying the cable delays and averaging increases the runtime by approximately a percent. On a high-end desktop with 32 GB of memory and a 3.20-GHz Intel Core i7-3930K processor with six cores, and with a 5 disc RAID setup, processing a single 2~min snapshot with a 0.5~s / 40~kHz input resolution, using common averaging settings to output at 2~s / 80~kHz resolution, approximately 3~min are spend on reading the data, 5~min on RFI detection and 3.5~min on writing the data. Real-time processing can therefore be achieved by using 6 of such nodes in parallel.

\section{Discussion}
\begin{itemize}
 \item SKA -- how to implement a Cotter for SKA?
 \item PAPER etc needs to use combinatorial/morphological flagging
 \item The presence of strong interference implies there might be weak interference present that is not easily seen or detected. 
\end{itemize}

\noindent\begin{figure}
\begin{center}\hspace*{-0.2cm}\includegraphics[width=9cm]{img/LOFAR-MWA-occupancy}
\caption{Comparison between LOFAR and MWA RFI occupancies. The statistics are regridded to the same frequency resolution of 48~kHz. }
\label{fig:lofar-mwa-occupancy}
\end{center}
\end{figure}

\subsection{Comparison with LOFAR}
The frequency range of the LOFAR high-band antennas (HBAs) overlaps with the MWA frequency range, and this therefore allows to compare the RFI situations at the same frequencies. The RFI occupancies for LOFAR from \citet{lofar-radio-environment} and for the MWA from this work are plotted over the HBA frequency range of 115--163~MHz in Fig.~\ref{fig:lofar-mwa-occupancy}. The statistics are regridded to the same frequency resolution of 48~kHz. The average RFI occupancy in this frequency range is 1.65\% for the MWA, while O2012 reports a 3.18\% occupancy for LOFAR.

It should be noted that the RFI detection for LOFAR was performed at 0.78~kHz while for the MWA it is performed at 40~kHz. As shown in O2012, LOFAR observes RFI that is only a single or a few 0.78~kHz channels wide, and consequently due to MWA's lower frequency resolution, the MWA will only detect the brightest of such transmissions. O2012 also show that ionospheric scintillation of Cassiopeia~A triggers detection events, and this is one of the reasons for LOFAR's relatively high minimum occupancy level of $\sim2\%$ RFI, in comparison to 0.5\% for the MWA. In the MWA data, no false detections have been seen that are caused by ionospheric scintillation, likely because of the absence of the strongest sources: Cassiopeia~A is never visible at the MWA, and Cygnus~A is only visible at low declinations. An additional explanation could also be that the sidelobe behaviour between MWA and LOFAR is also different due to the difference between MWA tiles and LOFAR stations. Taking into account these differences, it becomes hard to compare the environments fairly based on detected RFI levels. Nevertheless, for both telescopes, the automatic detection strategies have been optimized such that as little data as possible is thrown away but the detection is sufficient for further data reduction. For the MWA, this goal was reached by throwing away a factor of two less data.

After RFI detection, power spectra from both MWA and LOFAR show smooth curves without significant leakage, and the data are clean enough for further processing and imaging. While the difference between a 1.65\% or 3.18\% loss of data is hardly a reason to spend resources to build at a remote site like the Murchison Radio Observatory, there are additional reasons to do so. A benefit of building the MWA at a remote radio-quiet site, is that the MWA can observe in the FM-station bands (88--108~MHz). Initial MWA experiments have confirmed the availability of these bands for science \citep{mckinley-moon-2013,mwacs-2014}. Moreover, for both LOFAR and MWA, a primary science driver is the detection of signals from the EoR. Such a detection requires very deep integrations, and it could be that RFI becomes problematic when reaching lower noise levels. However, initial results with LOFAR predict that RFI will not prevent a detection of EoR signals \citep{ncp-eor-yatawatta, offringa-rfi-distributions}.

\section{Conclusions}
\begin{itemize}
 \item Much less RFI than LOFAR (but at a cost)
 \item About half the observations don't need flagging at all. 
 \item FM not completely empty
 \item Frequency behaviour of instrument makes things harder! Need to fix pass-band correction.
\end{itemize}

\section*{Acknowledgments}
This scientific work makes use of the Murchison Radio-astronomy Observatory, operated by CSIRO. We acknowledge the Wajarri Yamatji people as the traditional owners of the Observatory site. Support for the MWA comes from the U.S. National Science Foundation (grants AST-0457585, PHY-0835713, CAREER-0847753, and AST-0908884), the Australian Research Council (LIEF grants LE0775621 and LE0882938), the U.S. Air Force Office of Scientific Research (grant FA9550-0510247), and the Centre for All-sky Astrophysics (an Australian Research Council Centre of Excellence funded by grant CE110001020). Support is also provided by the Smithsonian Astrophysical Observatory, the MIT School of Science, the Raman Research Institute, the Australian National University, and the Victoria University of Wellington (via grant MED-E1799 from the New Zealand Ministry of Economic Development and an IBM Shared University Research Grant). The Australian Federal government provides additional support via the Commonwealth Scientific and Industrial Research Organisation (CSIRO), National Collaborative Research Infrastructure Strategy, Education Investment Fund, and the Australia India Strategic Research Fund, and Astronomy Australia Limited, under contract to Curtin University. We acknowledge the iVEC Petabyte Data Store, the Initiative in Innovative Computing and the CUDA Center for Excellence sponsored by NVIDIA at Harvard University, and the International Centre for Radio Astronomy Research (ICRAR), a Joint Venture of Curtin University and The University of Western Australia, funded by the Western Australian State government. 

% To make Dutch ``tussenvoegsels'' work correctly in Latex such as ``de Bruyn'', we use this command
% In bibliography, it should be written with lowercase, as in ``de Bruyn''
\DeclareRobustCommand{\TUSSEN}[3]{#3}

\bibliography{references}

\label{lastpage}

\end{document}
